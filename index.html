<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
  <title>Flipper</title>
</head>

<body>
  <style>
    table.dataTable thead .sorting:after,
    table.dataTable thead .sorting:before,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_asc:before,
    table.dataTable thead .sorting_asc_disabled:after,
    table.dataTable thead .sorting_asc_disabled:before,
    table.dataTable thead .sorting_desc:after,
    table.dataTable thead .sorting_desc:before,
    table.dataTable thead .sorting_desc_disabled:after,
    table.dataTable thead .sorting_desc_disabled:before {
      bottom: .5em;
    }

    input {
      margin-right: 5px !important;
    }

    @media screen and (min-width: 992px) {

      .modal-xl {

        width: 1440px;
        /* New width for large modal */

      }

    }
  </style>

  <div style="float:right;margin-right: 10px; width: 400px; height: 234px;">
    <a style="position: absolute;  margin-right: 34px;right: 0;margin-top: 5px;color:grey;" onclick="clearConsole()"
      href="#"><span class="glyphicon glyphicon-erase"></span></a>
    <textarea id="console" rows="8" cols="50" id="console" disabled
      style="resize: none;width: 100%; height:100%;overflow-y: scroll;">
  </textarea>
    <div class="progress">
      <div id="progress" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0"
        aria-valuemin="0" aria-valuemax="100" style="width: 0%; "></div>
    </div>
    <span id="progress-text">0%</span>
  </div>
  <!-- Info modal -->
  <div class="modal fade" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" style="float:left;" id="exampleModalLabel">Flipper - How to Use</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>For the best possible results, it is strongly suggested to use the Albion Data Client together with this
            tool. The API has no way of telling when an item has been sold, so it is therefore best to assume that if
            either the <strong>BM Age</strong> or <strong>City Age</strong> are high, the buy order has already been
            filled.</p>
          <p><br />As the best results are achieved by using the Albion Data Client, this tutorial will explain how to
            use Flipper in conjunction with the Albion Data Client. Start by downloading the data client from: <a
              href="http://www.albion-online-data.com" target="_blank">www.albion-online-data.com</a></p>
          <ol>
            <li>Make sure the Albion Data Client is running in the background:
              <br /><br />
              <img src="images\1.png" alt="" width="100%">
              <br /><br />
            </li>
            <li>Login to Albion Online and update the location of your character by switching locations (e.g. go out of
              the bank and then back into the bank). Example of how the Data Client should respond:
              <br /><br />
              <img src="images\2.png" alt="" width="100%" />
              <br /><br />
            </li>
            <li>Go to whatever market you want to flip from and select the <strong>Category</strong>,
              <strong>Tier</strong>, <strong>Enchantment</strong> and <strong>Quality</strong> of the items you want to
              flip. An efficient way of updating many items is to, for example, choose <strong>Tier 8</strong> and
              category: <strong>Accessories.</strong>
              <br /><br />
              <img src="images\3.png" alt="" />
              <br /><br />
            </li>
            <li>Keep pressing the next page arrow (marked with a red box in the image below) until you either hit page
              20 or there are no more pages with items left. In the image below we hit the maximum page 20 meaning that
              there are still more items we can update.
              <br /><br />
              <img src="images\4.png" alt="" />
              <br /><br />
            </li>
            <li>Click the <strong>Price</strong> column (marked with a red box in the image below) to sort the items in
              the opposite order (if previously they were sorted in ascending order, now they will be sorted in
              descending order). In our example the items are now in descending order (by price), meaning that they get
              cheaper as we go.
              <br /><br />
              <img src="images\5.png" alt="" />
              <br /><br />
            </li>
            <li>Repeat <strong>Step 4</strong>. Here you can stop once you reach the same prices as on the last page 20
              in <strong>Step 4</strong>. In the image below we can see that the prices on page 10 are descending from
              1&nbsp;289&nbsp;999. This means that the range of prices we updated is 79&nbsp;995 &ndash;
              1&nbsp;332&nbsp;999 (price of the first and last item in <strong>Step 3</strong> and <strong>4</strong>
              respectively) and 30&nbsp;000&nbsp;000 &ndash; 1&nbsp;279 998 (price of the first and last item in
              <strong>Step 5</strong> and <strong>6</strong> respectively). In other words, we have updated all the
              <strong>Tier 8 Accessories</strong> in the <strong>Fort Sterling</strong> market. Now repeat <strong>steps
                3 &ndash; 6</strong> for <strong>Armor</strong>, <strong>Magic</strong>, <strong>Melee</strong>,
              <strong>Off-Hand</strong>, <strong>Ranged</strong> and <strong>Tool</strong> categories.
              <br /><br />
              <img src="images\6.png" alt="" />
              <br /><br />
              While you are updating the items make sure the Albion Data Client is sending the updates (see the image
              below for how it looks when the items are being updated). If you are getting errors, try updating your
              location (leave and enter the market for example).
              <br /><br />
              <img src="images\6_2.png" alt="" width="100%" />
              <br /><br />
            </li>
            <li>Fast travel to the <strong>Black Market</strong> and update the same items as you did in the previous
              market (repeat <strong>steps 3 &ndash; 6</strong>). <strong>Hint: have one of your characters be in the
                Black Market so you can quickly switch characters and update the Black Market without fast
                travel!</strong>
              <br /><br />
            </li>
            <li>Choose the appropriate parameters in Flipper and click the &ldquo;Find Flips!&rdquo; button. Make sure
              the <strong>Max BM Age</strong> and <strong>Max City Age</strong> are as low as possible. The API has no
              way of knowing when an item has been sold, so if you choose a too large age there is a chance the buy
              order has already been filled. In our example we choose the following parameters:
              <br /><br />
              <img src="images\8.png" alt="" />
              <br /><br />
            </li>
            <li>Sort the table by profits by clicking the <strong>Profit (with tax)</strong> column title (marked with
              red box) and execute the top trades. If there are a lot of different entries feel free to add the ones you
              want to execute into the cart by pressing the plus button in the cart column (marked with red box).
              <strong>Hint: you can click on any cell in the table to copy its content. You can then, for example, paste
                the name of the item in the market search to find it and buy it faster!</strong>
              <br /><br />
              <img src="images\9.png" alt="" width="100%" />
              <br /><br />
              <img src="images\9_2.png" alt="" width="100%" />
              <br /><br />
            </li>
          </ol>
          <p><strong>Some Last Words and Tips</strong></p>
          <p>This is merely a suggestion on how to get started with Flipper. Updating items in this manner will usually
            not work for lower tiers that have a lot more items for sale than tier 8. In that case you will for example
            have to update each quality or enchantment one by one. If you know which items are usually profitable then
            you can only update these. </p>
          <p>If you wish to only flip items between the Caerleon market and the Black Market, then you can uncheck all
            the other cities. Caerleon is always checked as the program uses the Caerleon item data to warn users
            flipping from other cities if the same buy order can be filled by the Caerleon market. This causes Caerleon
            trades to also appear in the table, so sort first by profit and then by city if you only want to flip from
            another city and ignore Caerleon. </p>
          <p>The reason why quality is set to all and cannot be changed is because the program compares the different
            combinations of trades and qualities that can be made and displays the trades that would give the highest
            net profit if all the trades for the same item were executed. </p>
          <p>The key in market flipping is speed. The item data that you are sending is public and other people using
            Flipper will also see the same trades as you. You need to therefore be fast in updating the items and then
            executing the trades. If you don’t make a trade in time you can usually recover most of the money by putting
            it up for sale on one of the markets or on the Black Market, albeit it will take time to sell.</p>
          <p>On that note, we wish you good luck and happy flipping!</p>
          <iframe width="100%" src="https://www.youtube.com/embed/cz4VEmaDG7k" frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>
        </div>
        <div class="modal-footer">
          <button type="button" data-dismiss="modal" class="btn btn-primary">
            Let's Go!
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Shopping modal -->
  <div class="modal fade" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" style="float:left;" id="exampleModalLabel">Shopping Cart</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table id="cart" class="table table-bordered table-striped sortable" cellspacing="0" width="100%">
            <thead>
              <tr>
                <th data-toggle="tooltip" data-placement="top"
                  title="Tier and enchantment of the item in the format: TIER.ENCHANTMENT">Tier</th>
                <th data-toggle="tooltip" data-placement="top" title="Name of the item to flip">Name</th>
                <th data-toggle="tooltip" data-placement="top" title="Profit of the trade with tax included">Profit
                  (with tax)</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="Profit in percent calculated as (profit/city price)*100">% Profit</th>
                <th data-toggle="tooltip" data-placement="top" title="The price of the buy order in the Black Market">BM
                  Buy Price</th>
                <th data-toggle="tooltip" data-placement="top" title="The quality of the buy order in the Black Market">
                  BM Quality</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="The time (in minutes) since the buy order in the Black Market was updated by the Albion Data Client. Will always be less or equal to Max BM Age. If the age is large it can mean that the order has already been filled">
                  BM Age</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="The difference between buy and sell order in the Black Market. If it is small there is a risk that the buy order will be filled by the sell order before you can flip the item, especially if flipping between BM and other cities">
                  BM Order Diff.</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="The time (in minutes) since the sell order in the Black Market was updated by the Albion Data Client">
                  BM Order Diff. Age</th>
                <th data-toggle="tooltip" data-placement="top" title="Price of the item in the city">City Sell Price
                </th>
                <th data-toggle="tooltip" data-placement="top"
                  title="Quality of the item in the city. Can be higher than the BM Quality since you can sell higher quality items to lower quality buy orders">
                  City Quality</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="The time (in minutes) since the sell order in the city was updated by the Albion Data Client. Will always be less or equal to Max City Age. If the age is large it can mean that the order has already been filled">
                  City Age</th>
                <th data-toggle="tooltip" data-placement="top" title="The city where the item can be bought">City</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="If the Black Market buy order can be filled by an item in the Caerleon market. If you are flipping between BM and another city this serves as a warning since the same buy order can be filled much quicker by a Caerleon flipper">
                  Caerleon Profit</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="Quality of the item in Caerleon. Can be higher than the BM Quality since you can sell higher quality items to lower quality buy orders">
                  Caerleon Quality</th>
                <th data-toggle="tooltip" data-placement="top"
                  title="The time (in minutes) since the sell order in Caerleon was updated by the Albion Data Client. Displays items up to one week old as Caerleon prices do not fluctuate much">
                  Caerleon Age</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Total</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button onclick="clearTable('cart')" type="button" class="btn btn-danger btn-sm">
            <span class="glyphicon glyphicon-trash"></span> Clear
          </button>
        </div>
      </div>
    </div>
  </div>

  <div
    style="margin-top: 10px; margin-left:10px; width: 385px; height: 264px; border-style: solid; border-width: 1px; padding: 5px">
    Tier:
    <select id="tier">
      <option value="-1">All</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8" selected>8</option>
    </select>
    Enchantment:
    <select id="enchantment">
      <option value="-1" selected>All</option>
      <option value="0">0</option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
    </select>
    Quality:
    <select id="quality" disabled>
      <option value="0" selected>All</option>
      <option value="1">Normal</option>
      <option value="2">Good</option>
      <option value="3">Outstanding</option>
      <option value="4">Excellent</option>
      <option value="5">Masterpiece</option>
    </select>
    <br>
    <fieldset id="cities" style="margin-top: 10px;">
      <div style="float:left;margin-top: 10px;">
        <input type="checkbox" value="Fort Sterling" checked>Fort Sterling<br>
        <input type="checkbox" value="Thetford" checked>Thetford<br>
        <input type="checkbox" value="Lymhurst" checked>Lymhurst<br>
      </div>
      <div style="margin-left: 100px;margin-top: 10px;">
        <input type="checkbox" value="Bridgewatch" checked>Bridgewatch<br>
        <input type="checkbox" value="Martlock" checked>Martlock<br>
        <input type="checkbox" value="Caerleon" checked disabled>Caerleon<br>
      </div>
    </fieldset>
    <input id="premium" type="checkbox" checked>Premium<br>
    <div style="width:100%;">
      <div style="width:50%; position:block;float:left;">
        <label for="Min Profit">Min Profit</label><br>
        <input style="width: 90%;" type="number" id="minProfit" name="Min Profit" value=1 min="0">
        <button onclick="getPrices()" style="margin-top: 10px; width: 90%; padding-top:8px; padding-bottom:8px">Find
          Flips!</button>
      </div>
      <div style="width:50%; position:block;float:right;">
        <label for="Max BM Age">Max BM Age</label><br>
        <input style="width: 90%;" type="number" id="maxAgeBM" name="Max BM Age" value=20><br>
        <label for="Max City Age">Max City Age</label><br>
        <input style="width: 90%;" type="number" id="maxAgeCity" name="Max City Age" value=20><br>
      </div>
    </div>
    <br>
  </div>
  <!-- Shopping trigger -->
  <button type="button" style="float:right;margin-right: 10px;" class="btn btn-info btn-sm" data-toggle="modal"
    data-target="#cartModal">
    <span class="glyphicon glyphicon-shopping-cart"></span> Shopping Cart
  </button>
  <button onclick="clearTable('table')" type="button" style="float:right;margin-right: 10px;"
    class="btn btn-danger btn-sm">
    <span class="glyphicon glyphicon-trash"></span> Clear
  </button>
  <button type="button" style="float:right;margin-right: 10px;" class="btn btn-primary btn-sm" data-toggle="modal"
    data-target="#infoModal">
    <span class="glyphicon glyphicon-question-sign"></span> Tutorial
  </button>
  <div style="position: absolute;margin-top: 10px;margin-left: 10px;">
    Got any suggestions or bugs that you would like to report? Join us on discord
    <a href="https://discord.gg/2ySkAuX">https://discord.gg/2ySkAuX</a>
  </div>
  <br>
  <br>
  <table id="table" class="table table-bordered table-striped sortable" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th data-toggle="tooltip" data-placement="top"
          title="Tier and enchantment of the item in the format: TIER.ENCHANTMENT">Tier</th>
        <th data-toggle="tooltip" data-placement="top" title="Name of the item to flip">Name</th>
        <th data-toggle="tooltip" data-placement="top" title="Profit of the trade with tax included">Profit (with tax)
        </th>
        <th data-toggle="tooltip" data-placement="top" title="Profit in percent calculated as (profit/city price)*100">%
          Profit</th>
        <th data-toggle="tooltip" data-placement="top" title="The price of the buy order in the Black Market">BM Buy
          Price</th>
        <th data-toggle="tooltip" data-placement="top" title="The quality of the buy order in the Black Market">BM
          Quality</th>
        <th data-toggle="tooltip" data-placement="top"
          title="The time (in minutes) since the buy order in the Black Market was updated by the Albion Data Client. Will always be less or equal to Max BM Age. If the age is large it can mean that the order has already been filled">
          BM Age</th>
        <th data-toggle="tooltip" data-placement="top"
          title="The difference between buy and sell order in the Black Market. If it is small there is a risk that the buy order will be filled by the sell order before you can flip the item, especially if flipping between BM and other cities">
          BM Order Diff.</th>
        <th data-toggle="tooltip" data-placement="top"
          title="The time (in minutes) since the sell order in the Black Market was updated by the Albion Data Client">
          BM Order Diff. Age</th>
        <th data-toggle="tooltip" data-placement="top" title="Price of the item in the city">City Sell Price</th>
        <th data-toggle="tooltip" data-placement="top"
          title="Quality of the item in the city. Can be higher than the BM Quality since you can sell higher quality items to lower quality buy orders">
          City Quality</th>
        <th data-toggle="tooltip" data-placement="top"
          title="The time (in minutes) since the sell order in the city was updated by the Albion Data Client. Will always be less or equal to Max City Age. If the age is large it can mean that the order has already been filled">
          City Age</th>
        <th data-toggle="tooltip" data-placement="top" title="The city where the item can be bought">City</th>
        <th data-toggle="tooltip" data-placement="top"
          title="If the Black Market buy order can be filled by an item in the Caerleon market. If you are flipping between BM and another city this serves as a warning since the same buy order can be filled much quicker by a Caerleon flipper">
          Caerleon Profit</th>
        <th data-toggle="tooltip" data-placement="top"
          title="Quality of the item in Caerleon. Can be higher than the BM Quality since you can sell higher quality items to lower quality buy orders">
          Caerleon Quality</th>
        <th data-toggle="tooltip" data-placement="top"
          title="The time (in minutes) since the sell order in Caerleon was updated by the Albion Data Client. Displays items up to one week old as Caerleon prices do not fluctuate much">
          Caerleon Age</th>
        <th data-toggle="tooltip" data-placement="top" title="Add the flip to the shopping cart">Cart</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  <br>

  <script type="text/javascript" src="js/items.js"></script>
  <script type="text/javascript" src="js/main.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"
    integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous">
  </script>
  <script type="text/javascript" src="js/bootstrap/bootstrap-sortable.js"></script>
  <script type="text/javascript" src="js/moment.js"></script>
</body>

</html>